name: Mergebot02

on:
  workflow_run:
    workflows:
      - Pull request
    types:
      - completed
  workflow_dispatch:

jobs:
  auto-merge:
    name: Auto merge
    runs-on: ubuntu-latest
    timeout-minutes: 1
    steps:
      - name: generate_token    
        uses: jarylc/github-app-token@v3.0.1
        with:
          app: ${{ secrets.APP_ID }}
          key: ${{ secrets.PRIVATE_KEY }}
          # Optional (defaults to the current owner)
          # owner: jarylc
      - name: Use Token
        env:
          TOKEN: ${{ steps.generate_token.outputs.token }}
        run: |
          echo "The generated token is masked: ${TOKEN} Ubaid-Today"
          
      - name: Generate token
        id: generate_token     
        uses: tibdex/github-app-token@v1      
        with:
          app_id: ${{ secrets.APP_ID }}
          private_key: ${{ secrets.PRIVATE_KEY }}
          
      - name: Use token
        env:
          TOKEN: ${{ steps.generate_token.outputs.token }}     
          run: "print token here ${ TOKEN }"
          github_token: ${ TOKEN }
        uses: e-conomic/mergebot@v1
        with:        
          reviewers: ${{ secrets.PLATFORM_REVIEWERS }}
          semver_match: minor
